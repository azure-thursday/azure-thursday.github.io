name: Update documentation on pull request

on:
  # Runs on pushes targeting the default branch
  pull_request:
        types: [closed]
        branches: ["main"]
  workflow_dispatch:

jobs:
 update-docs:
    if: github.event.pull_request.merged == true
    runs-on: ubuntu-latest
    steps:
        - name: Check-out devops repository
          uses: actions/checkout@v2
      
        - name: Install OpenAI Python package
          run: pip install openai

        - name: Call LLM
          env:
            AZURE_OPENAI_ENDPOINT: ${{ secrets.AZURE_OPENAI_ENDPOINT }}
            AZURE_OPENAI_KEY: ${{ secrets.AZURE_OPENAI_KEY }}
            AZURE_OPENAI_DEPLOYMENT: ${{ secrets.AZURE_OPENAI_DEPLOYMENT }}
          run: python /.github/workflows/scripts/call_llm.py
    

